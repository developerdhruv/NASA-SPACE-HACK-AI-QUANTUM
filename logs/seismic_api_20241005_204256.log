2024-10-05 20:42:56,983 - api - INFO - Using device: cuda
2024-10-05 20:42:57,175 - api - INFO - All models and scalers loaded successfully
2024-10-05 20:43:12,934 - api - INFO - PINN processing completed. Shape of denoised_data: (100,)
2024-10-05 20:43:12,942 - api - INFO - GAN processing completed. Shape of generated_samples: (10, 100)
2024-10-05 20:43:12,942 - api - INFO - Augmented data prepared. Shape: (11, 100)
2024-10-05 20:43:12,943 - api - INFO - Shape of augmented_data after reshaping: (11, 100)
2024-10-05 20:43:12,943 - api - INFO - Shape of vae_input: torch.Size([11, 100])
2024-10-05 20:43:12,944 - api - WARNING - Mismatch between VAE input_dim (50) and data shape (100)
2024-10-05 20:43:12,948 - api - INFO - Adjusted vae_input shape: torch.Size([11, 50])
2024-10-05 20:43:12,949 - api - ERROR - Error in VAE processing: both arguments to linear need to be at least 1D, but they are 0D and 2D
2024-10-05 20:43:12,952 - api - ERROR - Traceback (most recent call last):
  File "E:\nasa_space_hack24\api.py", line 183, in process_seismic_data_task
    anomalies, original_data, reconstructed_data = detect_anomalies(vae_model, vae_input, device, vae_scaler)
                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\vaee\train.py", line 84, in detect_anomalies
    recon, _, _ = vae(data)
                  ^^^^^^^^^
  File "E:\nasa_space_hack24\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\vaee\train.py", line 49, in forward
    mu, logvar = self.encode(x)
                 ^^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\vaee\train.py", line 37, in encode
    h = self.encoder(x)
        ^^^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\.venv\Lib\site-packages\torch\nn\modules\container.py", line 219, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\.venv\Lib\site-packages\torch\nn\modules\linear.py", line 117, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: both arguments to linear need to be at least 1D, but they are 0D and 2D

2024-10-05 20:43:12,954 - api - ERROR - Unexpected error processing seismic data: Error in VAE processing: both arguments to linear need to be at least 1D, but they are 0D and 2D
2024-10-05 20:43:12,956 - api - ERROR - Traceback (most recent call last):
  File "E:\nasa_space_hack24\api.py", line 183, in process_seismic_data_task
    anomalies, original_data, reconstructed_data = detect_anomalies(vae_model, vae_input, device, vae_scaler)
                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\vaee\train.py", line 84, in detect_anomalies
    recon, _, _ = vae(data)
                  ^^^^^^^^^
  File "E:\nasa_space_hack24\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\vaee\train.py", line 49, in forward
    mu, logvar = self.encode(x)
                 ^^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\vaee\train.py", line 37, in encode
    h = self.encoder(x)
        ^^^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\.venv\Lib\site-packages\torch\nn\modules\container.py", line 219, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\nasa_space_hack24\.venv\Lib\site-packages\torch\nn\modules\linear.py", line 117, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: both arguments to linear need to be at least 1D, but they are 0D and 2D

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "E:\nasa_space_hack24\api.py", line 189, in process_seismic_data_task
    raise ValueError(f"Error in VAE processing: {str(e)}")
ValueError: Error in VAE processing: both arguments to linear need to be at least 1D, but they are 0D and 2D

2024-10-05 20:43:12,959 - api - ERROR - Error in process_seismic_file endpoint: Unexpected error: Error in VAE processing: both arguments to linear need to be at least 1D, but they are 0D and 2D
